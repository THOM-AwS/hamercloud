<!DOCTYPE html>
<html lang="en">

<head>
	<!-- Google Tag Manager -->
	<script>(function (w, d, s, l, i) {
			w[l] = w[l] || []; w[l].push({
				'gtm.start':
					new Date().getTime(), event: 'gtm.js'
			}); var f = d.getElementsByTagName(s)[0],
				j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
					'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
		})(window, document, 'script', 'dataLayer', 'GTM-M9HCPGN');</script>
	<!-- End Google Tag Manager -->
	<title>Thomas Hamer Cloud Consulting</title>
	<link rel="shortcut icon" type="image/jpg" href="favicon.ico" />
	<meta charset="utf-8" />
	<meta name="keywords" content="AWS, Thomas Hamer, Cloud, Consulting, Freelance, solution, architect">
	<meta name="description"
		content="Senior AWS Cloud Solutions Architect, Technical Lead, and consultant. Making cool AWS things.">
	<meta name="author" content="Thomas Hamer">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="assets/css/main.css" />
	<noscript>
		<link rel="stylesheet" href="assets/css/noscript.css" />
	</noscript>
	<script src="assets/js/jquery.min.js"></script>
	<style type="text/css">
		/* Set the size of the div element that contains the map */
		#map {
			height: 400px;
			/* The height is 400 pixels */
			width: 100%;
			/* The width is the width of the web page */
		}
	</style>

</head>

<body class="is-preload">
	<!-- Google Tag Manager (noscript) -->
	<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-M9HCPGN" height="0" width="0"
			style="display:none;visibility:hidden"></iframe></noscript>
	<!-- End Google Tag Manager (noscript) -->

	<!-- Wrapper -->
	<div id="wrapper">

		<!-- Header -->
		<header id="header">
			<div class="logo">
				<i class="fab fa-aws fa-2x"></i>
			</div>
			<div class="content">
				<div class="inner">
					<h1>Thomas Hamer<br>Cloud Engineering</h1>
					<p>Making cool AWS things.</p>

					<ul class="icons">
						<li>
							<div class="icon-container">
								<a href="https://github.com/THOM-AwS">
									<i class="icon brands fa-github"></i>
								</a>
								<span>GitHub</span>
							</div>
						</li>
						<li>
							<div class="icon-container">
								<a href="https://www.credly.com/users/thomas-hamer.e6d54a9e/badges">
									<i class="fas fa-user-graduate"></i>
								</a>
								<span>Certs</span>
							</div>
						</li>
						<li>
							<div class="icon-container">
								<a href="https://www.linkedin.com/in/thomas-hamer-28b510186/">
									<i class="fab fa-linkedin-in"></i>
								</a>
								<span>Linkedin</span>
							</div>
						</li>
						<li>
							<div class="icon-container">
								<a href="https://www.youtube.com/channel/UCLDJEHICJL3rpzmyeGPX-Sw">
									<i class="fab fa-youtube"></i>
								</a>
								<span>YouTube</span>
							</div>
						</li>
						<li>
							<div class="icon-container">
								<a href="https://www.chess.com/member/spartan00117">
									<i class="fas fa-chess"></i>
								</a>
								<span>Chess</span>
							</div>
						<li>
							<div class="icon-container">
								<a href="https://www.hackerrank.com/profile/thomas_hamer">
									<i class="fab fa-hackerrank"></i>
								</a>
								<span>Hacker-Rank</span>
							</div>
						</li>
					</ul>
				</div>
			</div>
			<nav>
				<ul>
					<li><a href="#intro">Intro</a></li>
					<li><a href="#work">Work</a></li>
					<li><a href="#services">services</a></li>
					<li><a href="#contact">Contact</a></li>
					<!--<li><a href="#elements">Elements</a></li>-->
				</ul>
			</nav>
		</header>

		<!-- Main -->
		<div id="main">

			<!-- Intro -->
			<article id="intro">
				<h2 class="major">Intro</h2>
				<img src="images/thomas.jpg" alt="Thomas Hamer"
					style="width:200px;height:200px;float:left;padding: 20px;" />
				<p>I'm Thomas. </p>
				<img src="images/suitNgongs.jpg" alt="Thomas Hamer"
					style="width:200px;height:480px;float:right;padding: 20px;" />
				<p>I live and breathe travelling, and I've worked in countries around the world. In all, I've been to
					about 45 countries. I've had a blast at every one of them. No, I can't pick a favorite, Yes, I am
					planning on going to all ~200 of them.</p>
				<p>I'm obsessive about snowboarding. I have spent a few seasons boarding in southern Europe. It's as
					good as they say. My next stop is very likely the snowfields of Hakuba, Japan <i
						class="fas fa-snowboarding"></i></p>
				<img src="images/boarding.jpg" alt="Thomas Hamer" style="width:200px;float:left;padding: 20px;" />
				<p>In the past, I had a few different jobs. Now that I have found the best job in the world,<br><br> I
					am an AWS Solutions Architect.<i class="fab fa-aws"></i></p>
			</article>

			<!-- Work -->
			<article id="work">
				<h2 class="major">Work</h2>
				<span class="image main"><img src="images/aws.png" alt=""
						style="width:50%;height:50%;margin-left: 25%;" /></span>
				<h3><u>Introduction:</u></h3>
				<h4>Education</h4>
				<ul>
					<li><i class="fas fa-user-graduate"></i> <a
							href="https://www.tafensw.edu.au/course/-/c/c/ICT50418-01/Diploma-of-Information-Technology-Networking">Diploma
							of Information-Technology in Networking at TAFE</a></li>
					<li><i class="fas fa-user-graduate"></i> <a
							href="https://www.latrobe.edu.au/courses/bachelor-of-applied-cloud-technology">Degree in
							Applied Cloud Technology at La Trobe University.</a> <sub>(In Progress)</sub></li>
				</ul>
				<h4>Certifications</h4>
				<ul>
					<li><i class="fab fa-aws"></i>&nbsp;&nbsp;AWS Solutions Architect Professional</li>
					<li><i class="fab fa-aws"></i>&nbsp;&nbsp;AWS Solutions Architect Associate</li>
					<li><i class="fab fa-aws"></i>&nbsp;&nbsp;AWS SysOps Administrator Associate</li>
					<li><i class="fab fa-aws"></i>&nbsp;&nbsp;AWS Developer Associate</li>
					<li><i class="fab fa-aws"></i>&nbsp;&nbsp;AWS Cloud Practitioner</li>
					<li><i class="fas fa-terminal"></i>&nbsp;&nbsp;Hashicorp Terraform Associate</li>
				</ul>
				<p>
				<h4>Skills</h4> Currently working in the financial sector building AWS Magic.<br>During the time I
				previously spent working in consulting, I have cared for companies that would be described as household
				names, and mid to large size companies. <br><br>Healthcare, Banking and Finance, Blockchain, Mining, Oil
				and Gas, Telecommunications, Retail, and Food & Beverage. Ive assisted in taking care of large complex
				systems.<br><br>I am the founder of the <a href="https://www.meetup.com/en-AU/Zero-Days/">Zero-Days
					Meetup.</a> I gave a talk here on SSH:<style>
					.embed-container {
						position: relative;
						padding-bottom: 56.25%;
						height: 0;
						overflow: hidden;
						max-width: 100%;
					}

					.embed-container iframe,
					.embed-container object,
					.embed-container embed {
						position: absolute;
						top: 0;
						left: 0;
						width: 100%;
						height: 100%;
					}
				</style>
				<div class='embed-container'><iframe src='https://www.youtube.com/embed/fc3J2VU4YMs'
						allowfullscreen></iframe></div>
				</p>
				<ul>
					<li><i class="fas fa-battery-full"></i>&nbsp;&nbsp;AWSCLI</li>
					<li><i class="fas fa-battery-full"></i>&nbsp;&nbsp;Linux</li>
					<li><i class="fas fa-battery-three-quarters"></i>&nbsp;&nbsp;Windows</li>
					<li><i class="fas fa-battery-full"></i>&nbsp;&nbsp;Bash/ZSH scripting</li>
					<li><i class="fas fa-battery-full"></i>&nbsp;&nbsp;SSH</li>
					<li><i class="fas fa-battery-half"></i>&nbsp;&nbsp;Python</li>
					<li><i class="fas fa-battery-quarter"></i></i>&nbsp;&nbsp;Java</li>
					<li><i class="fas fa-battery-half"></i>&nbsp;&nbsp;C++</li>
					<li><i class="fas fa-battery-three-quarters"></i>&nbsp;&nbsp;Git</li>
					<li><i class="fas fa-battery-half"></i>&nbsp;&nbsp;CICD</li>
				</ul>
				<p>I created some really amazing projects for some very cool people. </p>
				<p>
				<h3><u>Project A:</u></h3> Using AWS Amplify, we made a Netflix style service to help the elderly to
				enjoy tailored content made just for them. Using an AWS template we created a service that could take
				uploads from a web portal that was protected by AWS Cognito, we can upload video content to an S3 bucket
				for processing with the media encoder service. That encoded footage is put in a new bucket for
				consumption by cloudfront when users login. The data is tracked by putting metadata into a Dynamo table.
				The application was written in React.
				<section style="font-size: 15px;">
					<br>
					<h4>Services</h4>
					<ul class="alt">
						<li>AWS Amplify</li>
						<li>AWS CodeCommit</li>
						<li>AWS Cognito</li>
						<li>AWS DynamoDB</li>
						<li>AWS S3</li>
						<li>AWS Lambda</li>
						<li>AWS Elemental MediaConvert</li>
						<li>AWS Elemental MediaLive</li>
						<li>AWS Cloudfront</li>
						<li>AWS Cloudwatch</li>
						<li>AWS AppSync</li>
						<li>AWS Route53</li>
					</ul>
					<img src="images/amplifyvod.png" alt="Video on demand" style="width:100%;" />
				</section>
				</p>
				<p>
				<h3><u>Project B:</u></h3> I helped an IT security company to fully uplift all their infrastructure into
				an up to date, considered and designed three tier VPC.<br>NAT Gateways, Application load balancers with
				AWS Cognito + MFA. Uplifted all their current applications. Setup instance profiles, Systems Manager,
				and cloudwatch agents. New applications were rolled out to new infrastructure, and major version updates
				for Gitlab, Elasticsearch, Kibana, Logstash, Wazuh, Greenbone Security Manager, Nessus, and Gophish.
				<section style="font-size: 15px;">
					<br>
					<h4>Services</h4>
					<ul class="alt">
						<li>AWS VPC</li>
						<li>AWS Route53</li>
						<li>AWS EC2</li>
						<li>AWS SSM</li>
						<li>AWS Cognito</li>
						<li>AWS S3</li>
						<li>AWS IAM</li>
						<li>AWS ACM</li>
						<li>AWS RDS</li>
						<li>AWS CloudWatch</li>
						<li>AWS Backup</li>
					</ul>
				</section>
				</p>
				<img src="images/vpccog.png" alt="VPC" style="width:100%;" />
				<p>The majority of my work code is in private repos. <i class="fab fa-aws"></i></p>
			</article>

			<!-- About -->
			<article id="services">
				<h2 class="major">Services</h2>
				<span class="image main"><img src="images/ethernet.jpg" alt="Photo by mike gieson from FreeImages"
						style="width:100%;height:100%;" /></span>
				<p>I can help you to achieve your goals too.</p>
				<p><u>Freelancing:</u> If you are looking for help to build your infrastructure service, or you are
					looking for assistance to design your idea to run in AWS, get in touch with me on the contact page.
				</p>
				<p><u>Coaching:</u> If you are looking for someone to give you some training in a friendly laid back
					flexible way, I can help you with that. I can do out of business hours coaching on weekends or after
					hours.<br><br><a href="https://hamer.cloud/#contact">Contact me here.</a><i class="fab fa-aws"></i>
				</p>
			</article>

			<!-- Contact -->
			<article id="contact">
				<h2 class="major">Contact</h2>
				<h3 class="major">Me:</h3>
				<p>You can reach me on my mobile by voice or text, Signal, or Email at: <br> <i class="fa fa-phone"
						aria-hidden="true"> </i><a href="tel:+61403255489"> +61403255489</a><br><i
						class="fas fa-at"></i> <a href="mailto:tom@hamer.cloud">
						tom@hamer.cloud</a></p>
				<p>If I have been outside in the last 3 hours, you will be able to see where I am, if not it will
					default to Sydney City. Zoom out to see where I have been.</p>


				<h3>Visited Countries</h3>
				<p>Count: <span id="countriesCount"></span></p>

				<p>
				<div id="map"></div>
				<script>
					function initMap() {
						const map = new google.maps.Map(document.getElementById("map"), {
							zoom: 14,
							mapTypeId: "satellite",
							disableDefaultUI: true,
						});

						var geoJsonUrl = 'https://datahub.io/core/geo-countries/r/countries.geojson';

						// List of countries you've visited
						var visitedCountries = [
							//"Aruba",
							//"Afghanistan",
							//"Angola",
							//"Anguilla",
							//"Albania",
							//"Aland",
							//"Andorra",
							"United Arab Emirates",
							//"Argentina",
							//"Armenia",
							//"American Samoa",
							//"Antarctica",
							//"Ashmore and Cartier Islands",
							//"French Southern and Antarctic Lands",
							//"Antigua and Barbuda",
							"Australia",
							"Austria",
							//"Azerbaijan",
							//"Burundi",
							"Belgium",
							//"Benin",
							//"Burkina Faso",
							//"Bangladesh",
							//"Bulgaria",
							"Bahrain",
							//"The Bahamas",
							//"Bosnia and Herzegovina",
							//"Saint Barthelemy",
							//"Belarus",
							//"Belize",
							//"Bermuda",
							//"Bolivia",
							//"Brazil",
							//"Barbados",
							"Brunei",
							//"Bhutan",
							//"Botswana",
							//"Central African Republic",
							"Canada",
							"Switzerland",
							//"Chile",
							//"China",
							//"Ivory Coast",
							//"Clipperton Island",
							//"Cameroon",
							//"Cyprus No Mans Area",
							"Democratic Republic of the Congo",
							//"Republic of the Congo",
							//"Cook Islands",
							//"Colombia",
							//"Comoros",
							//"Cape Verde",
							//"Costa Rica",
							//"Cuba",
							//"Curaçao",
							//"Cayman Islands",
							//"Northern Cyprus",
							//"Cyprus",
							"Czech Republic",
							"Germany",
							//"Djibouti",
							//"Dominica",
							"Denmark",
							//"Dominican Republic",
							//"Algeria",
							//"Ecuador",
							//"Egypt",
							//"Eritrea",
							"Spain",
							//"Estonia",
							//"Ethiopia",
							//"Finland",
							//"Fiji",
							//"Falkland Islands",
							"France",
							//"Faroe Islands",
							//"Federated States of Micronesia",
							//"Gabon",
							"United Kingdom of Great Britain and Northern Ireland",
							//"Georgia",
							//"Guernsey",
							//"Ghana",
							//"Gibraltar",
							//"Guinea",
							//"Gambia",
							//"Guinea Bissau",
							//"Equatorial Guinea",
							"England",
							//"Greece",
							//"Grenada",
							//"Greenland",
							//"Guatemala",
							//"Guam",
							//"Guyana",
							"Hong Kong S.A.R",
							//"Heard Island and McDonald Islands",
							//"Honduras",
							"Croatia",
							//"Haiti",
							"Hungary",
							//"Indonesia",
							//"Isle of Man",
							//"India",
							//"Indian Ocean Territories",
							"British Indian Ocean Territory",
							"Ireland",
							//"Iran",
							//"Iraq",
							//"Iceland",
							//"Israel",
							"Italy",
							//"Jamaica",
							//"Jersey",
							//"Jordan",
							//"Japan",
							//"Kazakhstan",
							//"Kenya",
							//"Kyrgyzstan",
							//"Cambodia",
							//"Kiribati",
							//"Saint Kitts and Nevis",
							//"South Korea Republic of Korea",
							//"Kosovo",
							//"Kuwait",
							//"Laos",
							//"Lebanon",
							//"Liberia",
							//"Libya",
							//"Saint Lucia",
							"Liechtenstein",
							//"Sri Lanka",
							//"Lesotho",
							//"Lithuania",
							"Luxembourg",
							//"Latvia",
							//"Macao S.A.R",
							//"Saint Martin",
							//"Morocco",
							//"Monaco",
							//"Moldova",
							//"Madagascar",
							//"Maldives",
							//"Mexico",
							//"Marshall Islands",
							//"Macedonia",
							//"Mali",
							//"Malta",
							//"Myanmar",
							//"Montenegro",
							//"Mongolia",
							//"Northern Mariana Islands",
							//"Mozambique",
							//"Mauritania",
							//"Montserrat",
							//"Mauritius",
							//"Malawi",
							"Malaysia",
							//"Namibia",
							//"New Caledonia",
							//"Niger",
							//"Nigeria",
							//"Nicaragua",
							//"Niue",
							"Netherlands",
							"Norway",
							//"Nepal",
							//"Nauru",
							"New Zealand",
							"Oman",
							//"Pakistan",
							//"Panama",
							//"Pitcairn Islands",
							//"Peru",
							//"Spratly Islands",
							//"Philippines",
							//"Palau",
							//"Papua New Guinea",
							"Poland",
							//"Puerto Rico",
							//"North Korea",
							//"Portugal",
							//"Paraguay",
							//"Palestine",
							//"French Polynesia",
							//"Qatar",
							//"Romania",
							//"Russia",
							//"Rwanda",
							//"Western Sahara",
							//"Saudi Arabia",
							"Scotland",
							//"Sudan",
							//"South Sudan",
							//"Senegal",
							"Singapore",
							//"South Georgia and the South Sandwich Islands",
							//"Saint Helena",
							//"Solomon Islands",
							//"Sierra Leone",
							//"El Salvador",
							//"San Marino",
							//"Somaliland",
							//"Somalia",
							//"Saint Pierre and Miquelon",
							//"Republic of Serbia",
							//"Sao Tome and Principe",
							//"Suriname",
							"Slovakia",
							"Slovenia",
							"Sweden",
							//"Swaziland",
							//"Sint Maarten",
							//"Seychelles",
							//"Syria",
							//"Turks and Caicos Islands",
							//"Chad",
							//"Togo",
							"Thailand",
							//"Tajikistan",
							//"Turkmenistan",
							//"East Timor",
							//"Tonga",
							//"Trinidad and Tobago",
							//"Tunisia",
							"Turkey",
							//"Tuvalu",
							"Taiwan",
							//"United Republic of Tanzania",
							//"Uganda",
							//"Ukraine",
							//"United States Minor Outlying Islands",
							//"Uruguay",
							"United States of America",
							//"US Naval Base Guantanamo Bay",
							//"Uzbekistan",
							"Vatican",
							//"Saint Vincent and the Grenadines",
							//"Venezuela",
							//"British Virgin Islands",
							//"United States Virgin Islands",
							"Vietnam",
							//"Vanuatu",
							//"Wallis and Futuna",
							//"Samoa",
							//"Yemen",
							"South Africa",
							//"Zambia",
							//"Zimbabwe",
						];

						function updateCountriesCount() {
							let count = visitedCountries.length;
							document.getElementById('countriesCount').textContent = count;
						}
						// Call the function to update the count
						updateCountriesCount();

						fetch(geoJsonUrl)
							.then(response => response.json())
							.then(data => {
								map.data.addGeoJson(data);

								map.data.setStyle(function (feature) {
									var countryName = feature.getProperty('ADMIN');
									var color = visitedCountries.includes(countryName) ? 'green' : 'red'; // Green for visited

									return {
										fillColor: color,
										strokeWeight: 1
									};
								});
								map.data.forEach(function (feature) {
									// Get the centroid of the feature (country)
									var centroid = getCentroid(feature.getGeometry());
									var countryName = feature.getProperty('ADMIN'); // Use 'ADMIN' to get the country name

									// Check if countryName is defined and is a string
									if (typeof countryName === 'string') {
										// Create a marker for the label
										var marker = new google.maps.Marker({
											position: centroid,
											map: map,
											label: {
												text: countryName, // Use countryName as label text
												color: 'black', // Adjust label style as needed
												fontSize: '12px'
											},
											icon: {
												path: google.maps.SymbolPath.CIRCLE,
												fillOpacity: 0,
												strokeOpacity: 0,
												scale: 0  // to create an invisible icon
											}
										});
									}
								});
							})
							.catch(error => console.error('Error loading GeoJSON data:', error));

						fetchDataAndUpdateMap(map);
					}

					// Function to calculate the centroid of a geometry
					function getCentroid(geometry) {
						var lat = 0;
						var lng = 0;
						var numPoints = 0;

						// Process each geometry in the GeoJSON GeometryCollection
						geometry.forEachLatLng(function (latlng) {
							lat += latlng.lat();
							lng += latlng.lng();
							numPoints++;
						});

						// Calculate the average coordinates
						lat = lat / numPoints;
						lng = lng / numPoints;

						return { lat: lat, lng: lng };
					}


					function fetchDataAndUpdateMap(map) {
						fetch('https://api.hamer.cloud/data')
							.then(response => response.json())
							.then(data => {
								if (!data || data.length === 0) {
									console.error('Error: No data received.');
									return;
								}

								const currentTime = Date.now();
								data.sort((a, b) => a.timestamp - b.timestamp);

								let previousPosition = null;
								let previousTimestamp = null;

								data.forEach((item, index) => {
									const position = new google.maps.LatLng(item.lat, item.lon);
									const isLatestPoint = index === data.length - 1;

									processEachDataPoint(item, isLatestPoint, position, currentTime, map);

									if (previousPosition && previousTimestamp) {
										createPolylineSegment(previousPosition, position, item, previousTimestamp, currentTime, map);
									}

									previousPosition = position;
									previousTimestamp = item.timestamp;
								});

								handlePolylineAnimation(data, map);
								adjustMapCenterAndZoom(data, map);
							})
							.catch(error => console.error('Error fetching data:', error));
					}

					function processEachDataPoint(item, isLatestPoint, position, currentTime, map) {
						const ageHours = (currentTime - (item.timestamp * 1000)) / (1000 * 60 * 60);
						let opacity = Math.max(1 - (ageHours / 4), 0);

						const circleOptions = getCircleOptions(isLatestPoint, position, item, opacity, map);
						const circle = new google.maps.Circle(circleOptions);
						circle.setMap(map);

						addInfoWindowToCircle(circle, item, position, map);

						// Add weather to the newest point
						if (isLatestPoint) {
							addWeatherToMap(map, item.lat, item.lon);
						}
					}

					function getCircleOptions(isLatestPoint, position, item, opacity, map) {
						if (isLatestPoint) {
							return {
								strokeColor: '#26de51',
								strokeOpacity: 1,
								strokeWeight: 3,
								fillColor: '#4285F4',
								fillOpacity: 0.2,
								map: map,
								center: position,
								radius: 40
							};
						} else {
							return {
								strokeColor: '#4285F4',
								strokeOpacity: opacity,
								strokeWeight: 2,
								fillColor: '#4285F4',
								fillOpacity: 0.2,
								map: map,
								center: position,
								radius: item.acc
							};
						}
					}

					function addInfoWindowToCircle(circle, item, position, map) {
						const infowindowContent = `
							<div>
								<span style="color: black;">Time: ${new Date(item.timestamp * 1000).toLocaleString()}</span><br>
								<span style="color: black;">Latitude: ${item.lat}</span><br>
								<span style="color: black;">Longitude: ${item.lon}</span><br>
								<span style="color: black;">Altitude: ${item.alt ? item.alt + ' meters' : 'N/A'}</span><br>
								<span style="color: black;">Accuracy: ${item.acc ? item.acc + ' meters' : 'N/A'}</span><br>
								<span style="color: black;">Battery: ${item.bat ? item.bat + '%' : 'N/A'}</span><br>
								<span style="color: black;">Satellites: ${item.sat ? item.sat : 'N/A'}</span><br>
								<span style="color: black;">User Agent: ${item.useragent ? item.useragent : 'N/A'}</span><br>
								<span style="color: black;">Speed: ${item.speed ? (item.speed * 3.6).toFixed(2) + ' km/h' : 'N/A'}</span><br>
								<span style="color: black;">Bearing: ${item.bearing ? item.bearing + '°' : 'N/A'}</span>
							</div>
						`;

						const infowindow = new google.maps.InfoWindow({
							content: infowindowContent,
							position: position
						});

						circle.addListener('click', () => {
							infowindow.open(map);
						});
					}

					function createPolylineSegment(previousPosition, position, item, previousTimestamp, currentTime, map) {
						const segmentAgeHours = (currentTime - ((item.timestamp + previousTimestamp) / 2 * 1000)) / (1000 * 60 * 60);
						let segmentOpacity = Math.max(1 - (segmentAgeHours / 3), 0);

						const lineSegment = new google.maps.Polyline({
							path: [previousPosition, position],
							geodesic: true,
							strokeColor: '#4285F4',
							strokeOpacity: segmentOpacity,
							strokeWeight: 2
						});

						lineSegment.setMap(map);
					}

					function handlePolylineAnimation(data, map) {
						if (data.length > 1) {
							const pathCoordinates = data.map(item => new google.maps.LatLng(item.lat, item.lon));
							animatePolyline(map, pathCoordinates);
						} else {
							console.log("Not enough data points for polyline animation.");
						}
					}

					function adjustMapCenterAndZoom(data, map) {
						if (data.length > 0) {
							const firstPoint = data[data.length - 1];
							addWeatherToMap(map, firstPoint.lat, firstPoint.lon);
							map.setCenter(new google.maps.LatLng(data[data.length - 1].lat, data[data.length - 1].lon));
							map.setZoom(14);
						}
					}

					function animatePolyline(map, pathCoordinates) {
						let linePath = new google.maps.Polyline({
							path: [],
							geodesic: true,
							strokeColor: '#FF0000',
							strokeOpacity: 1.0,
							strokeWeight: 2,
							map: map,
							zIndex: 1
						});

						let step = 0;
						const numSteps = pathCoordinates.length;
						let lastTime = performance.now();

						function drawLine(timestamp) {
							if (step >= numSteps) {
								step = 0;
								linePath.setPath([]);
							}
							const progress = timestamp - lastTime;
							if (progress >= 200) {
								linePath.getPath().push(pathCoordinates[step]);
								step++;
								lastTime = timestamp;
							}
							requestAnimationFrame(drawLine);
						}
						requestAnimationFrame(drawLine);
					}

					function addWeatherToMap(map, lat, lon) {
						const apiKey = '27dd553d3274c2f0760332bb947b1802';
						const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${apiKey}`;

						fetch(url)
							.then(response => {
								if (!response.ok) {
									throw new Error(`HTTP error! status: ${response.status}`);
								}
								return response.json();
							})
							.then(data => {
								if (data && data.weather) {
									const weather = data.weather[0];
									const main = data.main;
									const clouds = data.clouds;
									const wind = data.wind;
									const sys = data.sys;
									const iconUrl = "https://openweathermap.org/img/w/" + weather.icon + ".png";

									const tempCelsius = (main.temp - 273.15).toFixed(1);
									const feelsLikeCelsius = (main.feels_like - 273.15).toFixed(1);
									const minTempCelsius = (main.temp_min - 273.15).toFixed(1);
									const maxTempCelsius = (main.temp_max - 273.15).toFixed(1);

									const infowindowContent = `
										<div style="color: black;">
											<h3 style="color: black;">${data.name} Weather</h3><br>
											<img src="${iconUrl}" alt="${weather.description}" /><br>
											<span style="color: black;">Condition: ${weather.main} (${weather.description})</span><br>
											<span style="color: black;">Temperature: ${tempCelsius} °C (Feels like: ${feelsLikeCelsius} °C)</span><br>
											<span style="color: black;">Min/Max Temp: ${minTempCelsius} °C / ${maxTempCelsius} °C</span><br>
											<span style="color: black;">Pressure: ${main.pressure} hPa</span><br>
											<span style="color: black;">Humidity: ${main.humidity}%</span><br>
											<span style="color: black;">Wind: ${(wind.speed * 3.6).toFixed(2)} km/h, ${wind.deg} degrees</span><br>
											<span style="color: black;">Cloudiness: ${clouds.all}%</span><br>
											<span style="color: black;">Sunrise: ${new Date(sys.sunrise * 1000).toLocaleTimeString()}</span><br>
											<span style="color: black;">Sunset: ${new Date(sys.sunset * 1000).toLocaleTimeString()}</span><br>
										</div>
									`;

									const marker = new google.maps.Marker({
										position: { lat, lng: lon },
										map: map,
										icon: {
											url: iconUrl,
											// Set the anchor to offset the icon vertically
											anchor: new google.maps.Point(0, -35) // Adjust the second parameter to change vertical offset
										},
										title: weather.description
									});

									const infowindow = new google.maps.InfoWindow({
										content: infowindowContent
									});

									marker.addListener('click', () => {
										infowindow.open(map, marker);
									});
								} else {
									console.error('Weather data is missing');
								}
							})
							.catch(error => console.error('Error fetching weather data:', error));
					}

					function renderPolylines(map, pathCoordinates) {
						let bounds = map.getBounds();

						pathCoordinates.forEach((path) => {
							// Check if the path is within the map bounds
							if (bounds.contains(path)) {
								new google.maps.Polyline({
									path: path,
									geodesic: true,
									strokeColor: '#FF0000',
									strokeOpacity: 1.0,
									strokeWeight: 2,
									map: map
								});
							}
						});
					}

					google.maps.event.addListener(map, 'bounds_changed', function () {
						// Call your render function
						renderPolylines(map, pathCoordinates);
					});
				</script>

				<!-- Async script executes immediately and must be after any DOM elements used in callback. -->
				<script async defer
					src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCxyRHImShMxEssA12vkUWDYhv0Q6X7q1Y&libraries=&v=weekly&callback=initMap">
					</script>
				</p>
			</article>
		</div>
		<!-- Footer -->
		<footer id="footer">
			<p class="copyright">&copy; Thomas Hamer. Design: <a href="https://html5up.net">HTML5 UP</a><br> Thomas
				Hamer
				ABN <a href="https://www.abr.business.gov.au/ABN/View?abn=87430826790">87430826790</a> Sydney,
				Australia. Nov 2023.<br> This website runs on AWS S3, Cloudfront, Route53, ACM & Lambda@Edge for
				security headers, mapping API with API Gateway and Lambda.
			</p>
		</footer>
	</div>

	<!-- BG -->
	<div id="bg"></div>

	<!-- Scripts -->
	<script src="assets/js/jquery.min.js"></script>
	<script src="assets/js/browser.min.js"></script>
	<script src="assets/js/breakpoints.min.js"></script>
	<script src="assets/js/util.js"></script>
	<script src="assets/js/main.js"></script>
</body>

</html>